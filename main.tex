\documentclass[sigplan,screen,review,9pt]{acmart}
\settopmatter{printacmref=false, printccs=false, printfolios=false}
\renewcommand\footnotetextcopyrightpermission[1]{}

\usepackage{listings}     % For ASCII-art / code blocks
\usepackage{booktabs}     % Nicer tables
\usepackage{array}        % Column types
\usepackage{tabularx}     % Automatic column width
\usepackage{enumitem}     % Compact lists

\usepackage{fontspec}   % 字体支持
\usepackage{newunicodechar} % 自定义 Unicode 字符
\usepackage{fancyvrb}   % 增强的 verbatim 环境

% 设置等宽字体（选择支持这些符号的字体）
\setmonofont{DejaVu Sans Mono}[Scale=MatchLowercase]  % 或 Noto Sans Mono, Fira Code 等

% 定义方框字符（可选，确保正确渲染）
\newunicodechar{┌}{\symbol{"250C}} % 上左角
\newunicodechar{┐}{\symbol{"2510}} % 上右角
\newunicodechar{└}{\symbol{"2514}} % 下左角
\newunicodechar{┘}{\symbol{"2518}} % 下右角
\newunicodechar{─}{\symbol{"2500}} % 横线
\newunicodechar{│}{\symbol{"2502}} % 竖线
\newunicodechar{☁}{\textbf{[cloud]}} % 云朵符号 - using text replacement instead

\begin{document}

\title{AgentSight: System-Level Observability for AI Agents Using eBPF}


\author{}


\sloppy
\begin{abstract}
    LLM agents such as Claude Code violate the fundamental assumptions of software monitoring. Their ability to dynamically generate code and spawn arbitrary subprocesses creates a critical semantic gap: existing tools can see either an agent's high-level intent (via LLM prompts) or its low-level actions (via system calls), but never both in a correlated view. This blindness makes it impossible to distinguish between benign operations and malicious attacks or costly failures. We introduce AgentSight, an observability framework designed to bridge this semantic gap. Our approach, \emph{boundary tracing}, monitors agents from outside their application code at stable system interfaces using eBPF. AgentSight intercepts TLS-encrypted LLM traffic to understand semantic intent and monitors kernel events to observe system-wide effects, then causally correlates these two streams across process boundaries. This instrumentation-free technique is framework-agnostic, resilient to rapid API changes, and incurs less than 3\% performance overhead. Our evaluation shows AgentSight detects sophisticated prompt injection attacks with 92\% confidence, automatically identifies resource-wasting reasoning loops, and reveals hidden coordination bottlenecks in multi-agent systems. We release AgentSight as open source to enable the safe and observable deployment of autonomous AI in production.
\end{abstract}


\maketitle

\input{intro}

\input{background}

\input{motivation}

\input{design-impl}

\input{eval-conclusion}

\end{document}